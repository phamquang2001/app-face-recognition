{"ast":null,"code":"import * as faceapi from 'face-api.js';\n\n// Load models and weights\nexport async function loadModels() {\n  const MODEL_URL = process.env.PUBLIC_URL + '/models';\n  await faceapi.loadTinyFaceDetectorModel(MODEL_URL);\n  await faceapi.loadFaceLandmarkTinyModel(MODEL_URL);\n  await faceapi.loadFaceRecognitionModel(MODEL_URL);\n}\n\n// export async function getFullFaceDescription(blob, inputSize = 512) {\n//   // tiny_face_detector options\n//   let scoreThreshold = 0.5;\n//   const OPTION = new faceapi.TinyFaceDetectorOptions({\n//     inputSize,\n//     scoreThreshold\n//   });\n//   const useTinyModel = true;\n\n//   // fetch image to api\n//   let img = await faceapi.fetchImage(blob);\n\n//   // detect all faces and generate full description from image\n//   // including landmark and descriptor of each face\n//   let fullDesc = await faceapi\n//     .detectAllFaces(img, OPTION)\n//     .withFaceLandmarks(useTinyModel)\n//     .withFaceDescriptors();\n//   return fullDesc;\n// }\nasync function getFullFaceDescription(blob, inputSize = 512) {\n  if (!blob) {\n    throw new Error('Blob is null or undefined');\n  }\n\n  // tiny_face_detector options\n  let scoreThreshold = 0.5;\n  const OPTION = new faceapi.TinyFaceDetectorOptions({\n    inputSize,\n    scoreThreshold\n  });\n  const useTinyModel = true;\n\n  // fetch image to api\n  let img = await (faceapi === null || faceapi === void 0 ? void 0 : faceapi.fetchImage(blob));\n\n  // detect all faces and generate full description from image\n  // including landmark and descriptor of each face\n  let fullDesc = await faceapi.detectAllFaces(img, OPTION).withFaceLandmarks(useTinyModel).withFaceDescriptors();\n  return fullDesc;\n}\nconst maxDescriptorDistance = 0.5;\nexport async function createMatcher(faceProfile) {\n  // Create labeled descriptors of member from profile\n  let members = Object.keys(faceProfile);\n  let labeledDescriptors = members.map(member => new faceapi.LabeledFaceDescriptors(faceProfile[member].name, faceProfile[member].descriptors.map(descriptor => new Float32Array(descriptor))));\n\n  // Create face matcher (maximum descriptor distance is 0.5)\n  let faceMatcher = new faceapi.FaceMatcher(labeledDescriptors, maxDescriptorDistance);\n  return faceMatcher;\n}","map":{"version":3,"names":["faceapi","loadModels","MODEL_URL","process","env","PUBLIC_URL","loadTinyFaceDetectorModel","loadFaceLandmarkTinyModel","loadFaceRecognitionModel","getFullFaceDescription","blob","inputSize","Error","scoreThreshold","OPTION","TinyFaceDetectorOptions","useTinyModel","img","fetchImage","fullDesc","detectAllFaces","withFaceLandmarks","withFaceDescriptors","maxDescriptorDistance","createMatcher","faceProfile","members","Object","keys","labeledDescriptors","map","member","LabeledFaceDescriptors","name","descriptors","descriptor","Float32Array","faceMatcher","FaceMatcher"],"sources":["C:/Users/quang/OneDrive/Desktop/TestProject/my-app/src/api/face.js"],"sourcesContent":["import * as faceapi from 'face-api.js';\r\n\r\n// Load models and weights\r\nexport async function loadModels() {\r\n  const MODEL_URL = process.env.PUBLIC_URL + '/models';\r\n  await faceapi.loadTinyFaceDetectorModel(MODEL_URL);\r\n  await faceapi.loadFaceLandmarkTinyModel(MODEL_URL);\r\n  await faceapi.loadFaceRecognitionModel(MODEL_URL);\r\n}\r\n\r\n// export async function getFullFaceDescription(blob, inputSize = 512) {\r\n//   // tiny_face_detector options\r\n//   let scoreThreshold = 0.5;\r\n//   const OPTION = new faceapi.TinyFaceDetectorOptions({\r\n//     inputSize,\r\n//     scoreThreshold\r\n//   });\r\n//   const useTinyModel = true;\r\n\r\n//   // fetch image to api\r\n//   let img = await faceapi.fetchImage(blob);\r\n\r\n//   // detect all faces and generate full description from image\r\n//   // including landmark and descriptor of each face\r\n//   let fullDesc = await faceapi\r\n//     .detectAllFaces(img, OPTION)\r\n//     .withFaceLandmarks(useTinyModel)\r\n//     .withFaceDescriptors();\r\n//   return fullDesc;\r\n// }\r\nasync function getFullFaceDescription(blob, inputSize = 512) {\r\n  if (!blob) {\r\n    throw new Error('Blob is null or undefined');\r\n  }\r\n\r\n  // tiny_face_detector options\r\n  let scoreThreshold = 0.5;\r\n  const OPTION = new faceapi.TinyFaceDetectorOptions({\r\n    inputSize,\r\n    scoreThreshold\r\n  });\r\n  const useTinyModel = true;\r\n\r\n  // fetch image to api\r\n  let img = await faceapi?.fetchImage(blob);\r\n\r\n  // detect all faces and generate full description from image\r\n  // including landmark and descriptor of each face\r\n  let fullDesc = await faceapi\r\n    .detectAllFaces(img, OPTION)\r\n    .withFaceLandmarks(useTinyModel)\r\n    .withFaceDescriptors();\r\n  return fullDesc;\r\n}\r\n\r\n\r\n  \r\nconst maxDescriptorDistance = 0.5;\r\nexport async function createMatcher(faceProfile) {\r\n  // Create labeled descriptors of member from profile\r\n  let members = Object.keys(faceProfile);\r\n  let labeledDescriptors = members.map(\r\n    member =>\r\n      new faceapi.LabeledFaceDescriptors(\r\n        faceProfile[member].name,\r\n        faceProfile[member].descriptors.map(\r\n          descriptor => new Float32Array(descriptor)\r\n        )\r\n      )\r\n  );\r\n\r\n  // Create face matcher (maximum descriptor distance is 0.5)\r\n  let faceMatcher = new faceapi.FaceMatcher(\r\n    labeledDescriptors,\r\n    maxDescriptorDistance\r\n  );\r\n  return faceMatcher;\r\n}"],"mappings":"AAAA,OAAO,KAAKA,OAAO,MAAM,aAAa;;AAEtC;AACA,OAAO,eAAeC,UAAUA,CAAA,EAAG;EACjC,MAAMC,SAAS,GAAGC,OAAO,CAACC,GAAG,CAACC,UAAU,GAAG,SAAS;EACpD,MAAML,OAAO,CAACM,yBAAyB,CAACJ,SAAS,CAAC;EAClD,MAAMF,OAAO,CAACO,yBAAyB,CAACL,SAAS,CAAC;EAClD,MAAMF,OAAO,CAACQ,wBAAwB,CAACN,SAAS,CAAC;AACnD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeO,sBAAsBA,CAACC,IAAI,EAAEC,SAAS,GAAG,GAAG,EAAE;EAC3D,IAAI,CAACD,IAAI,EAAE;IACT,MAAM,IAAIE,KAAK,CAAC,2BAA2B,CAAC;EAC9C;;EAEA;EACA,IAAIC,cAAc,GAAG,GAAG;EACxB,MAAMC,MAAM,GAAG,IAAId,OAAO,CAACe,uBAAuB,CAAC;IACjDJ,SAAS;IACTE;EACF,CAAC,CAAC;EACF,MAAMG,YAAY,GAAG,IAAI;;EAEzB;EACA,IAAIC,GAAG,GAAG,OAAMjB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEkB,UAAU,CAACR,IAAI,CAAC;;EAEzC;EACA;EACA,IAAIS,QAAQ,GAAG,MAAMnB,OAAO,CACzBoB,cAAc,CAACH,GAAG,EAAEH,MAAM,CAAC,CAC3BO,iBAAiB,CAACL,YAAY,CAAC,CAC/BM,mBAAmB,CAAC,CAAC;EACxB,OAAOH,QAAQ;AACjB;AAIA,MAAMI,qBAAqB,GAAG,GAAG;AACjC,OAAO,eAAeC,aAAaA,CAACC,WAAW,EAAE;EAC/C;EACA,IAAIC,OAAO,GAAGC,MAAM,CAACC,IAAI,CAACH,WAAW,CAAC;EACtC,IAAII,kBAAkB,GAAGH,OAAO,CAACI,GAAG,CAClCC,MAAM,IACJ,IAAI/B,OAAO,CAACgC,sBAAsB,CAChCP,WAAW,CAACM,MAAM,CAAC,CAACE,IAAI,EACxBR,WAAW,CAACM,MAAM,CAAC,CAACG,WAAW,CAACJ,GAAG,CACjCK,UAAU,IAAI,IAAIC,YAAY,CAACD,UAAU,CAC3C,CACF,CACJ,CAAC;;EAED;EACA,IAAIE,WAAW,GAAG,IAAIrC,OAAO,CAACsC,WAAW,CACvCT,kBAAkB,EAClBN,qBACF,CAAC;EACD,OAAOc,WAAW;AACpB"},"metadata":{},"sourceType":"module","externalDependencies":[]}