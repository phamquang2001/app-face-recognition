{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/quang/OneDrive/Desktop/TestProject/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/quang/OneDrive/Desktop/TestProject/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import*as faceapi from'face-api.js';// Load models and weights\nexport function loadModels(){return _loadModels.apply(this,arguments);}function _loadModels(){_loadModels=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var MODEL_URL;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:MODEL_URL=process.env.PUBLIC_URL+'/models';_context.next=3;return faceapi.loadTinyFaceDetectorModel(MODEL_URL);case 3:_context.next=5;return faceapi.loadFaceLandmarkTinyModel(MODEL_URL);case 5:_context.next=7;return faceapi.loadFaceRecognitionModel(MODEL_URL);case 7:case\"end\":return _context.stop();}},_callee);}));return _loadModels.apply(this,arguments);}export function getFullFaceDescription(_x){return _getFullFaceDescription.apply(this,arguments);}function _getFullFaceDescription(){_getFullFaceDescription=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(blob){var inputSize,scoreThreshold,OPTION,useTinyModel,img,fullDesc,_args2=arguments;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:inputSize=_args2.length>1&&_args2[1]!==undefined?_args2[1]:512;if(blob){_context2.next=3;break;}throw new Error('Blob is null or undefined');case 3:// tiny_face_detector options\nscoreThreshold=0.5;OPTION=new faceapi.TinyFaceDetectorOptions({inputSize:inputSize,scoreThreshold:scoreThreshold});useTinyModel=true;// fetch image to api\n_context2.next=8;return faceapi===null||faceapi===void 0?void 0:faceapi.fetchImage(blob);case 8:img=_context2.sent;_context2.next=11;return faceapi.detectAllFaces(img,OPTION).withFaceLandmarks(useTinyModel).withFaceDescriptors();case 11:fullDesc=_context2.sent;return _context2.abrupt(\"return\",fullDesc);case 13:case\"end\":return _context2.stop();}},_callee2);}));return _getFullFaceDescription.apply(this,arguments);}var maxDescriptorDistance=0.5;export function createMatcher(_x2){return _createMatcher.apply(this,arguments);}function _createMatcher(){_createMatcher=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(faceProfile){var members,labeledDescriptors,faceMatcher;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:// Create labeled descriptors of member from profile\nmembers=Object.keys(faceProfile);labeledDescriptors=members.map(function(member){return new faceapi.LabeledFaceDescriptors(faceProfile[member].name,faceProfile[member].descriptors.map(function(descriptor){return new Float32Array(descriptor);}));});// Create face matcher (maximum descriptor distance is 0.5)\nfaceMatcher=new faceapi.FaceMatcher(labeledDescriptors,maxDescriptorDistance);return _context3.abrupt(\"return\",faceMatcher);case 4:case\"end\":return _context3.stop();}},_callee3);}));return _createMatcher.apply(this,arguments);}","map":{"version":3,"names":["faceapi","loadModels","_loadModels","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","MODEL_URL","wrap","_callee$","_context","prev","next","process","env","PUBLIC_URL","loadTinyFaceDetectorModel","loadFaceLandmarkTinyModel","loadFaceRecognitionModel","stop","getFullFaceDescription","_x","_getFullFaceDescription","_callee2","blob","inputSize","scoreThreshold","OPTION","useTinyModel","img","fullDesc","_args2","_callee2$","_context2","length","undefined","Error","TinyFaceDetectorOptions","fetchImage","sent","detectAllFaces","withFaceLandmarks","withFaceDescriptors","abrupt","maxDescriptorDistance","createMatcher","_x2","_createMatcher","_callee3","faceProfile","members","labeledDescriptors","faceMatcher","_callee3$","_context3","Object","keys","map","member","LabeledFaceDescriptors","name","descriptors","descriptor","Float32Array","FaceMatcher"],"sources":["C:/Users/quang/OneDrive/Desktop/TestProject/my-app/src/api/face.js"],"sourcesContent":["import * as faceapi from 'face-api.js';\r\n\r\n// Load models and weights\r\nexport async function loadModels() {\r\n  const MODEL_URL = process.env.PUBLIC_URL + '/models';\r\n  await faceapi.loadTinyFaceDetectorModel(MODEL_URL);\r\n  await faceapi.loadFaceLandmarkTinyModel(MODEL_URL);\r\n  await faceapi.loadFaceRecognitionModel(MODEL_URL);\r\n}\r\n\r\nexport async function getFullFaceDescription(blob, inputSize = 512) {\r\n  if (!blob) {\r\n    throw new Error('Blob is null or undefined');\r\n  }\r\n\r\n  // tiny_face_detector options\r\n  let scoreThreshold = 0.5;\r\n  const OPTION = new faceapi.TinyFaceDetectorOptions({\r\n    inputSize,\r\n    scoreThreshold\r\n  });\r\n  const useTinyModel = true;\r\n\r\n  // fetch image to api\r\n  let img = await faceapi?.fetchImage(blob);\r\n\r\n  // detect all faces and generate full description from image\r\n  // including landmark and descriptor of each face\r\n  let fullDesc = await faceapi\r\n    .detectAllFaces(img, OPTION)\r\n    .withFaceLandmarks(useTinyModel)\r\n    .withFaceDescriptors();\r\n  return fullDesc;\r\n}\r\nconst maxDescriptorDistance = 0.5;\r\nexport async function createMatcher(faceProfile) {\r\n  // Create labeled descriptors of member from profile\r\n  let members = Object.keys(faceProfile);\r\n  let labeledDescriptors = members.map(\r\n    member =>\r\n      new faceapi.LabeledFaceDescriptors(\r\n        faceProfile[member].name,\r\n        faceProfile[member].descriptors.map(\r\n          descriptor => new Float32Array(descriptor)\r\n        )\r\n      )\r\n  );\r\n\r\n  // Create face matcher (maximum descriptor distance is 0.5)\r\n  let faceMatcher = new faceapi.FaceMatcher(\r\n    labeledDescriptors,\r\n    maxDescriptorDistance\r\n  );\r\n  return faceMatcher;\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}