{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\quang\\\\OneDrive\\\\Desktop\\\\TestProject\\\\my-app\\\\src\\\\Photo\\\\Photo.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { loadModels, getFullFaceDescription, createMatcher } from \"../api/face\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst testImg = require(\"../img/anhthe.jpg\");\nconst JSON_PROFILE = require(\"../descriptors/bnk48.json\");\nconst INIT_STATE = {\n  imageURL: testImg,\n  fullDesc: null,\n  detections: null,\n  descriptors: null,\n  match: null,\n  faceMatcher: null\n};\nfunction ImageInput(props) {\n  _s();\n  const [state, setState] = useState({\n    ...INIT_STATE,\n    faceMatcher: null\n  });\n  let temp = INIT_STATE;\n  useEffect(() => {\n    initialize();\n  }, []);\n  async function initialize() {\n    await loadModels();\n    const faceMatcher = await createMatcher(JSON_PROFILE);\n    temp = {\n      imageURL: temp.imageURL,\n      fullDesc: temp.fullDesc,\n      detections: temp.detections,\n      descriptors: temp.descriptor,\n      match: temp.match,\n      faceMatcher: faceMatcher\n    };\n    await handleImage(temp.imageURL);\n  }\n  async function handleImage(image = temp.imageURL) {\n    const fullDesc = await getFullFaceDescription(image);\n    const faceMatcher = await createMatcher(JSON_PROFILE);\n    if (fullDesc && fullDesc.length > 0) {\n      temp = {\n        imageURL: temp.imageURL,\n        fullDesc: fullDesc,\n        detections: fullDesc.map(fd => fd.detection),\n        descriptors: fullDesc.map(fd => fd.descriptor),\n        match: temp.match,\n        faceMatcher: faceMatcher\n      };\n    }\n    if (!!temp.descriptors && !!temp.faceMatcher) {\n      const match = await temp.descriptors.map(descriptor => temp.faceMatcher.findBestMatch(descriptor));\n      temp = {\n        imageURL: temp.imageURL,\n        fullDesc: fullDesc,\n        detections: fullDesc.map(fd => fd.detection),\n        descriptors: fullDesc.map(fd => fd.descriptor),\n        match: temp.match,\n        faceMatcher: faceMatcher,\n        match: match\n      };\n      setState(temp);\n    }\n  }\n  async function handleFileChange(event) {\n    resetState();\n    const imageURL = URL.createObjectURL(event.target.files[0]);\n    temp = {\n      imageURL: imageURL\n    };\n    setState(temp);\n    handleImage();\n  }\n  function resetState() {\n    temp = {\n      INIT_STATE\n    };\n  }\n  const {\n    imageURL,\n    detections,\n    match\n  } = state;\n  let drawBox = null;\n  if (detections && detections.length > 0) {\n    drawBox = detections.map((detection, i) => {\n      const _H = detection.box.height;\n      const _W = detection.box.width;\n      const _X = detection.box._x;\n      const _Y = detection.box._y;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: \"absolute\",\n            border: \"solid\",\n            borderColor: \"blue\",\n            height: _H,\n            width: _W,\n            transform: `translate(${_X}px,${_Y}px)`\n          },\n          children: match && match[i] ? /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              backgroundColor: \"blue\",\n              border: \"solid\",\n              borderColor: \"blue\",\n              width: _W,\n              marginTop: 0,\n              color: \"#fff\",\n              transform: `translate(-3px,${_H}px)`\n            },\n            children: match[i]._label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this);\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      id: \"myFileUpload\",\n      type: \"file\",\n      onChange: handleFileChange,\n      accept: \".jpg, .jpeg, .png\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"relative\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: \"absolute\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: imageURL,\n          alt: \"imageURL\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), drawBox ? drawBox : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 5\n  }, this);\n}\n_s(ImageInput, \"lzCCQRqGeb59xQZyVokaOO+LEkQ=\");\n_c = ImageInput;\nexport default ImageInput;\nvar _c;\n$RefreshReg$(_c, \"ImageInput\");","map":{"version":3,"names":["React","useState","useEffect","withRouter","loadModels","getFullFaceDescription","createMatcher","jsxDEV","_jsxDEV","testImg","require","JSON_PROFILE","INIT_STATE","imageURL","fullDesc","detections","descriptors","match","faceMatcher","ImageInput","props","_s","state","setState","temp","initialize","descriptor","handleImage","image","length","map","fd","detection","findBestMatch","handleFileChange","event","resetState","URL","createObjectURL","target","files","drawBox","i","_H","box","height","_W","width","_X","_x","_Y","_y","children","style","position","border","borderColor","transform","backgroundColor","marginTop","color","_label","fileName","_jsxFileName","lineNumber","columnNumber","id","type","onChange","accept","src","alt","_c","$RefreshReg$"],"sources":["C:/Users/quang/OneDrive/Desktop/TestProject/my-app/src/Photo/Photo.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { loadModels, getFullFaceDescription, createMatcher } from \"../api/face\";\r\n\r\nconst testImg = require(\"../img/anhthe.jpg\");\r\nconst JSON_PROFILE = require(\"../descriptors/bnk48.json\");\r\n\r\nconst INIT_STATE = {\r\n  imageURL: testImg,\r\n  fullDesc: null,\r\n  detections: null,\r\n  descriptors: null,\r\n  match: null,\r\n  faceMatcher: null,\r\n};\r\n\r\nfunction ImageInput(props) {\r\n  const [state, setState] = useState({ ...INIT_STATE, faceMatcher: null });\r\n  let temp = INIT_STATE;\r\n\r\n  useEffect(() => {\r\n    initialize();\r\n  }, []);\r\n\r\n  async function initialize() {\r\n    await loadModels();\r\n    const faceMatcher = await createMatcher(JSON_PROFILE);\r\n    temp = {\r\n      imageURL: temp.imageURL,\r\n      fullDesc: temp.fullDesc,\r\n      detections: temp.detections,\r\n      descriptors: temp.descriptor,\r\n      match: temp.match,\r\n      faceMatcher: faceMatcher,\r\n    };\r\n\r\n    await handleImage(temp.imageURL);\r\n  }\r\n\r\n  async function handleImage(image = temp.imageURL) {\r\n    const fullDesc = await getFullFaceDescription(image);\r\n    const faceMatcher = await createMatcher(JSON_PROFILE);\r\n\r\n    if (fullDesc && fullDesc.length > 0) {\r\n      temp = {\r\n        imageURL: temp.imageURL,\r\n        fullDesc: fullDesc,\r\n        detections: fullDesc.map((fd) => fd.detection),\r\n        descriptors: fullDesc.map((fd) => fd.descriptor),\r\n        match: temp.match,\r\n        faceMatcher: faceMatcher,\r\n      };\r\n    }\r\n\r\n    if (!!temp.descriptors && !!temp.faceMatcher) {\r\n      const match = await temp.descriptors.map((descriptor) =>\r\n        temp.faceMatcher.findBestMatch(descriptor)\r\n      );\r\n\r\n      temp = {\r\n        imageURL: temp.imageURL,\r\n        fullDesc: fullDesc,\r\n        detections: fullDesc.map((fd) => fd.detection),\r\n        descriptors: fullDesc.map((fd) => fd.descriptor),\r\n        match: temp.match,\r\n        faceMatcher: faceMatcher,\r\n        match: match,\r\n      };\r\n      setState(temp);\r\n    }\r\n  }\r\n\r\n  async function handleFileChange(event) {\r\n    resetState();\r\n    const imageURL = URL.createObjectURL(event.target.files[0]);\r\n\r\n    temp = {\r\n      imageURL: imageURL,\r\n    };\r\n\r\n    setState(temp);\r\n    handleImage();\r\n  }\r\n\r\n  function resetState() {\r\n    temp = { INIT_STATE };\r\n  }\r\n\r\n  const { imageURL, detections, match } = state;\r\n\r\n  let drawBox = null;\r\n  if (detections && detections.length > 0) {\r\n    drawBox = detections.map((detection, i) => {\r\n      const _H = detection.box.height;\r\n      const _W = detection.box.width;\r\n      const _X = detection.box._x;\r\n      const _Y = detection.box._y;\r\n\r\n      return (\r\n        <div key={i}>\r\n          <div\r\n            style={{\r\n              position: \"absolute\",\r\n              border: \"solid\",\r\n              borderColor: \"blue\",\r\n              height: _H,\r\n              width: _W,\r\n             transform: `translate(${_X}px,${_Y}px)`,\r\n            }}\r\n          >\r\n            {match && match[i] ? (\r\n              <p\r\n                style={{\r\n                  backgroundColor: \"blue\",\r\n                  border: \"solid\",\r\n                  borderColor: \"blue\",\r\n                  width: _W,\r\n                  marginTop: 0,\r\n                  color: \"#fff\",\r\n                  transform: `translate(-3px,${_H}px)`,\r\n                }}\r\n              >\r\n                {match[i]._label}\r\n              </p>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <input\r\n        id=\"myFileUpload\"\r\n        type=\"file\"\r\n        onChange={handleFileChange}\r\n        accept=\".jpg, .jpeg, .png\"\r\n      />\r\n      <div style={{ position: \"relative\" }}>\r\n        <div style={{ position: \"absolute\" }}>\r\n          <img src={imageURL} alt=\"imageURL\" />\r\n        </div>\r\n        {drawBox ? drawBox : null}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default (ImageInput);"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}